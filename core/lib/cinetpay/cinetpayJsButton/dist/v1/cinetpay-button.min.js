if("undefined"==typeof CINETPAY||!CINETPAY)var CINETPAY={};CINETPAY.apps=CINETPAY.apps||{},function(a){"use strict";function f(){for(var b=a.getElementById("cinetpay-form"),e=0;e<b.length;e++)if("live"==b[e].name){var f=b[e].value;break}"yes"==f?(d=!1,c=!0):d=!0;var j=c?"https://":"http://",k=Object.freeze({cashDeskUri:j+g(d),signatureUri:j+h(d),checkPayStatusUri:j+i(d)}),l=a.getElementById("cinetpay-form");return l.action=k.cashDeskUri,k}function g(a){return a?b.URI_CASH_DESK_DEV:b.URI_CASH_DESK_PROD}function h(a){return a?b.URI_GET_SIGNATURE_DEV:b.URI_GET_SIGNATURE_PROD}function i(a){return a?b.URI_CHECK_PAY_STATUS_DEV:b.URI_CHECK_PAY_STATUS_PROD}function j(b){for(var c=a.getElementById("cinetpay-form"),d=new FormData,e=0;e<c.length;e++)d.append(c[e].name,c[e].value);var f=new XMLHttpRequest;f.onreadystatechange=function(){if(4==f.readyState&&200==f.status)for(var a=0;a<c.length;a++)if("signature"==c[a].name){var b=JSON.parse(f.responseText);if(!b.hasOwnProperty("status")){c[a].value=b;break}alert("Code:"+b.status.code+"\n Message:"+b.status.message)}},f.open("post",b.signatureUri),f.send(d)}function k(){var b,c,d,e;a.getElementById("cinetpay-button")||(b="",c=a.createElement("style"),d=".cinetpay-button",e=d+" button",b+=d+" { white-space: nowrap; }",b+=d+" .field-error {  border: 1px solid #FF0000; }",b+=d+" .hide { display: none; }",b+=d+" .error-box { background: #FFFFFF; border: 1px solid #DADADA; border-radius: 5px; padding: 8px; display: inline-block; }",b+=e+' { white-space: nowrap; overflow: hidden; border-radius: 13px; font-family: "Arial", bold, italic; font-weight: bold; font-style: italic; border: 1px solid #2ECC71; color: #000000; background: #2ECC71; position: relative; text-shadow: 0 1px 0 rgba(255,255,255,.5); cursor: pointer; z-index: 0; }',b+=e+':before { content: " "; position: absolute; width: 100%; height: 100%; border-radius: 11px; top: 0; left: 0; background: #2ECC71; background: -webkit-linear-gradient(top, #28B463 0%,#28B463 80%,#FFF8FC 100%); background: -moz-linear-gradient(top, #28B463 0%,#28B463 80%,#FFF8FC 100%); background: -ms-linear-gradient(top, #28B463 0%,#28B463 80%,#FFF8FC 100%); background: linear-gradient(top, #28B463 0%,#28B463 80%,#FFF8FC 100%); z-index: -2; }',b+=e+':after { content: " "; position: absolute; width: 98%; height: 60%; border-radius: 40px 40px 38px 38px; top: 0; left: 0; background: -webkit-linear-gradient(top, #fefefe 0%, #28B463 100%); background: -moz-linear-gradient(top, #fefefe 0%, #28B463 100%); background: -ms-linear-gradient(top, #fefefe 0%, #28B463 100%); background: linear-gradient(top, #fefefe 0%, #28B463 100%); z-index: -1; -webkit-transform: translateX(1%);-moz-transform: translateX(1%); -ms-transform: translateX(1%); transform: translateX(1%); }',b+=e+".small { padding: 3px 15px; font-size: 12px; }",b+=e+".large { padding: 4px 19px; font-size: 14px; }",c.type="text/css",c.id="cinetpay-button",c.styleSheet?c.styleSheet.cssText=b:c.appendChild(a.createTextNode(b)),a.getElementsByTagName("head")[0].appendChild(c))}function l(b,c){var d,e,f,g,h,i,j,k,l,n,o,p,q,s,t,u=a.createElement("form"),v=a.createElement("button"),x=a.createElement("input"),y=a.createElement("p"),z=a.createElement("label"),A=a.createElement("input"),B=a.createElement("select"),C=a.createElement("option"),D=b.items,E=[],F={};u.method="post",u.id="cinetpay-form",u.className="cinetpay-button",u.target="_top";var G=a.createElement("div");G.className="hide",G.id="errorBox",u.appendChild(G),A.type="text",A.className="cinetpay-input",y.className="cinetpay-group",z.className="cinetpay-label",B.className="cinetpay-select",x.type="hidden",i=D.size&&D.size.value||"large",j=D.lc&&D.lc.value||"fr_FR",k=w[j]||w.en_US,l=k[c],b.items.text&&(l=b.items.text.value,b.remove("text"));for(h in D)d=D[h],d.hasOptions?E.push(d):d.isEditable?(g=A.cloneNode(!0),g.name=d.key,g.value=d.value,f=z.cloneNode(!0),t=r.config.labels[d.key]||k[d.key]||d.key,f.htmlFor=d.key,f.appendChild(a.createTextNode(t)),f.appendChild(g),e=y.cloneNode(!0),e.appendChild(f),u.appendChild(e)):(g=e=x.cloneNode(!0),g.name=d.key,g.value=d.value,u.appendChild(e));E=m(E);for(h in E)if(d=E[h],E[h].hasOptions){if(F=d.value,F.options.length>1){g=x.cloneNode(!0),g.name="on"+d.displayOrder,g.value=F.label,n=B.cloneNode(!0),n.name="os"+d.displayOrder;for(p in F.options)if(q=F.options[p],"string"==typeof q)o=C.cloneNode(!0),o.value=q,o.appendChild(a.createTextNode(q)),n.appendChild(o);else for(s in q)o=C.cloneNode(!0),o.value=s,o.appendChild(a.createTextNode(q[s])),n.appendChild(o);f=z.cloneNode(!0),t=F.label||d.key,f.htmlFor=d.key,f.appendChild(a.createTextNode(t)),f.appendChild(n),f.appendChild(g)}else f=z.cloneNode(!0),t=F.label||d.key,f.htmlFor=d.key,f.appendChild(a.createTextNode(t)),g=x.cloneNode(!0),g.name="on"+d.displayOrder,g.value=F.label,f.appendChild(g),g=A.cloneNode(!0),g.name="os"+d.displayOrder,g.value=F.options[0]||"",g.setAttribute("data-label",F.label),f.appendChild(g);e=y.cloneNode(!0),e.appendChild(f),u.appendChild(e)}try{v.type="submit"}catch(a){v.setAttribute("type","submit")}return v.className="cinetpay-button "+i,v.appendChild(a.createTextNode(l)),u.appendChild(v),u}function m(a){return a.sort(function(a,b){return a.displayOrder-b.displayOrder}),a}function n(b,c){var d,e,f=s.replace("{env}",b.items.env.value),g=a.createElement("img"),h=f+"?",i=13,j=b.items;c=c&&c.value||250;for(e in j)d=j[e],h+=d.key+"="+encodeURIComponent(d.value)+"&";return h=encodeURIComponent(h),g.src=t.replace("{env}",b.items.env.value).replace("{url}",h).replace("{pattern}",i).replace("{size}",c),g}function o(a){var b,c,d,e,f,g={},h=[];if(b=a.attributes)for(f=0,e=b.length;e>f;f++)c=b[f],(d=c.name.match(/^data-option([0-9])([a-z]+)([0-9])?/i))?h.push({name:"option."+d[1]+"."+d[2]+(d[3]?"."+d[3]:""),value:c.value}):(d=c.name.match(/^data-([a-z0-9_]+)(-editable)?/i))&&(g[d[1]]={value:c.value,isEditable:!!d[2]});return p(h,g),g}function p(a,b){var c,d,e,f,g,h={};for(j=0;j<a.length;j++)for(c=a[j],d=c.name,e=d.split("."),f=e.shift(),g=h;f;)g[f]||(g[f]={}),e.length||(g[f]=c.value),g=g[f],f=e.shift();var i,j,k,l,m={},n={},o=[],p={},q=Object.prototype.hasOwnProperty;for(i in h)if(q.call(h,i)){l=h[i];for(j in l){b["option_"+j]={value:{options:"",label:l[j].name},hasOptions:!0,displayOrder:parseInt(j,10)},m=l[j].select,n=l[j].price,o=[];for(k in m)p={},n?(p[m[k]]=m[k]+" "+n[k],o.push(p)):o.push(m[k]);b["option_"+j].value.options=o}}}function q(){this.items={},this.add=function(a,b,c,d,e){this.items[a]={key:a,value:b,isEditable:c,hasOptions:d,displayOrder:e}},this.remove=function(a){delete this.items[a]}}Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});var b=Object.freeze({URI_CASH_DESK_PROD:"secure.cinetpay.com",URI_CASH_DESK_DEV:"secure.sandbox.cinetpay.com",URI_GET_SIGNATURE_PROD:"api.cinetpay.com/v1/?method=getSignatureByPost",URI_GET_SIGNATURE_DEV:"api.sandbox.cinetpay.com/v1/?method=getSignatureByPost",URI_CHECK_PAY_STATUS_PROD:"api.cinetpay.com/v1/?method=checkPayStatus",URI_CHECK_PAY_STATUS_DEV:"api.sandbox.cinetpay.com/v1/?method=checkPayStatus"}),c=!1,d=!1,r={},s="http://{env}.cinetpay.com",t="http://{env}.cinetpay.com/qrcode?data={url}&pattern={pattern}&height={size}",u="JavaScriptButton_{type}",v={designation:"cpm_designation",trans_id:"cpm_trans_id",language:"cpm_language",currency:"cpm_currency",amount:"cpm_amount",site_id:"cpm_site_id",payment_config:"cpm_payment_config",page_action:"cpm_page_action",version:"cpm_version",custom:"cpm_custom",callback:"notify_url",return_page:"return_url",cancel_page:"cancel_url",golive:"live",button_id:"hosted_button_id"},w={en_GB:{buynow:"Buy Now",donate:"Donate",paynow:"Pay Now"},fr_FR:{buynow:"Acheter",donate:"Faire un don",paynow:"Payer maintenant"}};if(CINETPAY.apps.ButtonFactory||(r.config={labels:{}},r.buttons={buynow:0,donate:0,qr:0},r.create=function(a,b,c,d){var h,i,m,e=new Date,f=e.toISOString().match(/(\d{4}\-\d{2}\-\d{2})T(\d{2}:\d{2}:\d{2})/),g=f[1]+" "+f[2],o=new q;if(!a)return!1;for(i in b)m=b[i],o.add(v[i]||i,m.value,m.isEditable,m.hasOptions,m.displayOrder);return c=c||"buynow",o.add("apikey",a),o.add("signature",""),o.add("cpm_trans_date",g),o.add("origine",u.replace(/\{type\}/,c)),o.add("env",""),"qr"===c?(h=n(o,o.items.size),o.remove("size")):h=l(o,c),k(),this.buttons[c]+=1,d&&d.appendChild(h),h},CINETPAY.apps.ButtonFactory=r),"undefined"!=typeof a){var x,y,z,A,B,C,D=CINETPAY.apps.ButtonFactory,E=a.getElementsByTagName("script");for(B=0,C=E.length;C>B;B++)x=E[B],x&&x.src&&(y=x&&o(x),z=y&&y.button&&y.button.value,A=x.src.split("?apikey=")[1],A&&(D.create(A,y,z,x.parentNode),x.parentNode.removeChild(x)));var F=f();j(F)}}(document),"object"==typeof module&&"object"==typeof module.exports&&(module.exports=CINETPAY);